"use strict";angular.module("ohtuProjektiAppApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/main"),a.state("header",{templateUrl:"views/header.html"}).state("footer",{templateUrl:"views/footer.html"}).state("main",{url:"/main",views:{"":{templateUrl:"views/main.html",controller:"MainCtrl"},"header@":{templateUrl:"views/header.html"}}}).state("login",{url:"/login",views:{"":{templateUrl:"views/login.html",controller:"LoginCtrl"},"header@":{templateUrl:"views/header.html"}}})}]),angular.module("ohtuProjektiAppApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ohtuProjektiAppApp").controller("LoginCtrl",["$scope","$state","gitapi","auth",function(a,b,c,d){a.signin=function(){var e=d.askAuth();e.done(function(d){c.loginWithToken(d.access_token),b.go("main"),a.$apply()}).fail(function(a){console.log(a)})}}]);var myApp=angular.module("ohtuProjektiAppApp");myApp.controller("MainCtrl",["$scope","$state","gitapi",function(a,b,c){if(c.isAuthenticated()){var d=c.getGithub(),e=d.getUser();e.repos(function(b,c){a.$apply(function(){a.repos=c})})}else b.go("login")}]),angular.module("ohtuProjektiAppApp").service("gitapi",function(){var a;return{loginWithToken:function(b){a=new Github({token:b,auth:"oauth"})},isAuthenticated:function(){return console.log("is logged in"),void 0!=a},getGithub:function(){return a}}}),angular.module("ohtuProjektiAppApp").service("auth",function(){return OAuth.initialize("CHkmXQc9pfI3vqPZectNDagrwSc"),{askAuth:function(){return OAuth.popup("github")}}}),angular.module("ohtuProjektiAppApp").service("github",["$http",function(a){function b(b,e,f,g,h){var i={method:b,url:d+e,data:f};c&&(i.headers={Authorization:"token "+c});var j=a(i).success(g);h&&j.error(h)}var c,d="https://api.github.com";return{loginWithToken:function(a){c=a},isAuthenticated:function(){return void 0!=c},user:function(a,c){b("GET","/users/"+a,null,c)},authenticatedUser:function(a){b("GET","/user",null,a)},userRepos:function(a,c){var d="/users/"+a+"/repos?type=all&per_page=1000&sort=updated";b("GET",d,null,c)},Issue:function(a,c){var d="/repos/"+a+"/"+c+"/issues";this.list=function(a,c){b("GET",d,a,c)},this.getIssue=function(a,c){b("GET",d+"/"+a,null,c)},this.createIssue=function(a,c){b("POST",d,a,c)},this.updateIssue=function(a,c,e){b("PATCH",d+"/"+a,c,e)},this.openIssue=function(a,c){b("PATCH",d+"/"+a,{state:"open"},c)},this.closeIssue=function(a,c){b("PATCH",d+"/"+a,{state:"closed"},c)}},Label:function(a,c){var d="/repos/"+a+"/"+c+"/labels";this.list=function(a,c){b("GET",d,a,c)},this.getLabel=function(a,c){b("GET",d+"/"+a,null,c)},this.createLabel=function(a,c){b("POST",d,a,c)},this.deleteLabel=function(a,c){b("DELETE",d+"/"+a,null,c)},this.updateLabel=function(a,c,e){b("PATCH",d+"/"+a,c,e)}},Milestone:function(a,c){var d="/repos/"+a+"/"+c+"/milestones";this.list=function(a,c){b("GET",d,a,c)},this.getMilestone=function(a,c){b("GET",d+"/"+a,null,c)},this.createMilestone=function(a,c){b("POST",d,a,c)},this.updateMilestone=function(a,c,e){b("PATCH",d+"/"+a,c,e)},this.deleteMilestone=function(a,c){b("DELETE",d+"/"+a,null,c)}}}}]);